Project Constitution: Todo App with Google AI Chat
1. Project Vision & Mission
Vision: To create a robust, scalable, and intelligent task management system that demonstrates modern full‑stack development practices, container orchestration, and AI integration.

Mission: Build a secure, user‑friendly application where users can manage students and their todos, with a smart AI assistant to enhance productivity, all deployed on Kubernetes to mirror real‑world DevOps workflows.

2. Core Principles
Simplicity: Code and architecture should be clean, maintainable, and easy to understand.

Security by Design: Authentication, authorization, and data protection are foundational, not an afterthought.

Modularity: Separate concerns between backend, frontend, and infrastructure to allow independent evolution.

Persistence: All critical data must survive restarts; use persistent volumes and host‑based PostgreSQL for longevity.

Observability: Logging and audit trails are essential for debugging and compliance.

AI‑Assisted Development: Leverage AI tools (like Gemini) for both the application’s chatbot and the development process itself.

3. Technology Stack
Backend: FastAPI (Python 3.11) – chosen for its speed, automatic OpenAPI docs, and async capabilities.

Frontend: Next.js 16 (React 19, TypeScript, Tailwind CSS) – for server‑side rendering, type safety, and a modern UI.

Database: PostgreSQL 16 – reliable, ACID‑compliant, runs on the host VPS for persistent storage.

Authentication: JWT with HTTP‑only cookies – secure, stateless, and compatible with modern browsers.

AI Integration: Google Gemini AI (generativeai package) – provides a conversational assistant to help users.

Containerization: Docker – encapsulates backend and frontend for consistent environments.

Orchestration: Kubernetes (Minikube) – manages deployments, services, and scaling; uses NodePort for external access.

Networking: socat port forwarding on the host to expose Kubernetes services via public IP.

Version Control: Git – all code is tracked; secrets are excluded via .gitignore.

4. Development Guidelines
Branch Strategy: Use main as the primary branch; feature branches for new work, merged via pull requests.

Code Style:

Python: Follow PEP 8, use type hints, and format with Black.

TypeScript: Enforce strict mode, use ESLint and Prettier.

Commit Messages: Write clear, descriptive commit messages in the imperative tense (e.g., "Add login endpoint").

Documentation: Maintain a README.md with setup instructions, and comment complex logic in code.

Testing: Write unit tests for critical backend endpoints and frontend utilities (future goal). For now, manual testing via curl and browser.

5. Architectural Principles
Backend: RESTful API with versioned endpoints (e.g., /api/v1/...). Use dependency injection for database sessions and authentication.

Frontend: Component‑based architecture using React hooks; global state managed with Zustand.

Database: One‑to‑many relationship between students100 and todo100; audit_log100 for tracking changes.

Separation of Concerns: Each router (auth, students, todos, chat, audit) handles its own logic and models.

6. Security Principles
Password Storage: Use bcrypt to hash passwords before storing in the database; never store plain text.

JWT Handling: Tokens are stored in HTTP‑only cookies to prevent XSS attacks; cookies are set with SameSite=Lax and Secure=false (for HTTP development).

CORS: Only allow the specific frontend origin (http://148.230.88.136:3430) with allow_credentials=True.

Role‑Based Access: Admin users (role = "admin") can register new users; regular users cannot.

Database Access: Restrict PostgreSQL connections to the Kubernetes pod network (10.244.0.0/16) via pg_hba.conf.

7. Testing Strategy
Manual Testing: Use browser DevTools and curl to verify endpoints and UI behavior.

Automated Testing (future): Implement pytest for backend and Jest for frontend when time permits.

Integration Testing: Test the full flow of login, student creation, todo creation, and AI chat.

8. Documentation Standards
README.md: Contains project overview, tech stack, setup instructions, and deployment steps.

API Documentation: Automatically generated by FastAPI at /docs and /redoc.

Code Comments: Explain non‑obvious logic, especially around security and database interactions.

This Constitution: Serves as a guiding document for development decisions.

9. Deployment & Operations
Kubernetes Manifests: All YAMLs stored in ~/todoapp-k8s/; include deployments, services, and persistent volume claims.

Database: PostgreSQL runs on the host VPS; backup strategy: periodic pg_dump.

Port Forwarding: Two systemd services (todoapp-backend-forward-socat and todoapp-frontend-socat) forward host ports to Minikube NodePorts.

Monitoring: Check pod status with kubectl get pods -n todoapp; logs via kubectl logs.

Updates: Rebuild Docker images and restart deployments after code changes.

10. AI Integration Principles
User‑Facing AI: Google Gemini chatbot assists users with questions about the app and their tasks. It uses the google.generativeai library (to be migrated to google.genai when stable).

Development‑Time AI: This constitution itself was created with the help of an AI assistant (DeepSeek) via a chat interface, demonstrating how AI can guide project planning and documentation.

Future Enhancements: Consider using AI for code reviews, test generation, or automated refactoring.

This constitution is a living document and will evolve as the project grows.

